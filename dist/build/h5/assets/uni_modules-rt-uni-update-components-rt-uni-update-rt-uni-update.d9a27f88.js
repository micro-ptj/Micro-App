import{_ as t,ar as e,as as a,ah as s,o as n,c as o,w as c,i as d,a as l,b as i,t as r,v as u,A as p,N as f,at as _,al as h,au as b,C as m}from"./index.d4fd57a9.js";var k=t({data:()=>({percent:0,updateBtn:!0,cancleBtn:!1,data:{describe:"1. 修复已知问题<br>2. 优化用户体验",edition_url:"https://mp-281e3ee8-3380-4740-9b6e-11eac5254879.cdn.bspapp.com/cloudstorage/cd703d88-ece5-4823-b922-dfe8b6c7b48c.apk",edition_force:1,package_type:0}}),onHide(){this.data.edition_force=0,e({delta:1})},onLoad({obj:t}){this.data=JSON.parse(t),0==this.data.edition_force&&(this.cancleBtn=!0)},onBackPress(){if(1==this.data.edition_force)return!0},methods:{cancel(){e({delta:1})},confirm(){0==this.data.package_type?this.data.edition_url.includes(".apk")?(this.updateBtn=!1,this.cancleBtn=!1,this.download()):(this.data.edition_force=0,plus.runtime.openURL(this.data.edition_url),e({delta:1})):(this.updateBtn=!1,this.cancleBtn=!1,this.download())},download(){let t=this.data.package_type,n=this;a({url:this.data.edition_url,success:a=>{200===a.statusCode&&(plus.runtime.install(a.tempFilePath,{force:!0},(function(){1==t&&plus.runtime.restart()}),(function(t){n.data.edition_force=0,s({title:t.message,icon:"none",duration:2500}),setTimeout((()=>{e()}),2e3)})),0==t&&(this.data.edition_force=0,e()))}}).onProgressUpdate((t=>{this.percent=t.progress}))}}},[["render",function(t,e,a,s,k,g){const y=p,B=f,x=d,w=_,C=h,v=b,F=m;return n(),o(x,{class:"mask flex-center"},{default:c((()=>[l(x,{class:"content botton-radius"},{default:c((()=>[l(x,{class:"content-top"},{default:c((()=>[l(y,{class:"content-top-text"},{default:c((()=>[i("发现新版本")])),_:1}),l(B,{class:"content-top",style:{top:"0"},width:"100%",height:"100%",src:"/uni_modules/rt-uni-update/static/bg_top.png"})])),_:1}),l(x,{class:"content-header"}),l(x,{class:"content-body"},{default:c((()=>[l(x,{class:"title"},{default:c((()=>[l(y,null,{default:c((()=>[i("更新内容")])),_:1})])),_:1}),l(x,{class:"body"},{default:c((()=>[l(C,{class:"box-des-scroll","scroll-y":"true"},{default:c((()=>[l(w,{nodes:k.data.describe},null,8,["nodes"])])),_:1})])),_:1}),l(x,{class:"footer flex-center"},{default:c((()=>[k.updateBtn?r("",!0):(n(),o(x,{key:0,class:"progress-box flex-column"},{default:c((()=>[l(v,{class:"progress","border-radius":"35",percent:k.percent,activeColor:"#3DA7FF","show-info":"","stroke-width":"10"},null,8,["percent"]),l(x,null,{default:c((()=>[l(y,null,{default:c((()=>[i("正在下载，请稍后")])),_:1})])),_:1})])),_:1})),k.updateBtn?(n(),o(F,{key:1,class:"content-button",style:{border:"none",color:"#fff"},plain:"",onClick:g.confirm},{default:c((()=>[i("立即升级")])),_:1},8,["onClick"])):r("",!0)])),_:1})])),_:1}),k.cancleBtn?(n(),o(B,{key:0,class:"close-img",src:"/uni_modules/rt-uni-update/static/app_update_close.png",onClick:u(g.cancel,["stop"])},null,8,["onClick"])):r("",!0)])),_:1})])),_:1})}],["__scopeId","data-v-0a3dc936"]]);export{k as default};
