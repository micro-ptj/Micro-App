import{_ as e,o as t,c as i,w as a,z as s,a as o,b as n,y as r,q as m,A as l,i as u,d,D as c,r as f,R as h,am as p,f as T,Y as g,Q as _,an as b,ah as S,F as y,j as x,k as w,m as k,l as M}from"./index.d4fd57a9.js";import{_ as D}from"./u-image.431b9d49.js";import{_ as v}from"./u-button.68d3804d.js";import{_ as H,a as R,b as j}from"./u-form.d85f7ae7.js";import{_ as L}from"./u-popup.1e1348c5.js";function O(e,t=2){let i=`${e}`;for(;i.length<t;)i=`0${i}`;return i}function V(e){return{days:Math.floor(e/864e5),hours:Math.floor(e%864e5/36e5),minutes:Math.floor(e%36e5/6e4),seconds:Math.floor(e%6e4/1e3),milliseconds:Math.floor(e%1e3)}}var $=e({name:"u-count-down",emits:["change","end","finish"],props:{timestamp:{type:[String,Number],default:0},format:{type:String,default:"DD:HH:mm:ss"},autoStart:{type:Boolean,default:!0},customStyle:{type:[String,Object],default:""}},data:()=>({timer:null,timeData:V(0),formattedTime:"0",runing:!1,endTime:0,remainTime:0}),watch:{timestamp(e){this.reset()},format(e,t){this.pause(),this.start()}},mounted(){this.init()},methods:{init(){this.reset()},start(){this.runing||(this.runing=!0,this.endTime=Date.now()+this.remainTime,this.toTick())},toTick(){this.format.indexOf("SSS")>-1?this.microTick():this.macroTick()},macroTick(){this.clearTimeout(),this.timer=setTimeout((()=>{const e=this.getRemainTime();var t,i;t=e,i=this.remainTime,(Math.floor(t/1e3)!==Math.floor(i/1e3)||0===e)&&this.setRemainTime(e),0!==this.remainTime&&this.macroTick()}),30)},microTick(){this.clearTimeout(),this.timer=setTimeout((()=>{this.setRemainTime(this.getRemainTime()),0!==this.remainTime&&this.microTick()}),30)},getRemainTime(){return Math.max(this.endTime-Date.now(),0)},setRemainTime(e){this.remainTime=e;const t=V(e);this.$emit("change",t),this.formattedTime=function(e,t){let{days:i,hours:a,minutes:s,seconds:o,milliseconds:n}=t;return-1===e.indexOf("DD")?a+=24*i:e=e.replace("DD",O(i)),-1===e.indexOf("HH")?s+=60*a:e=e.replace("HH",O(a)),-1===e.indexOf("mm")?o+=60*s:e=e.replace("mm",O(s)),-1===e.indexOf("ss")?n+=1e3*o:e=e.replace("ss",O(o)),e.replace("SSS",O(n,3))}(this.format,t),e<=0&&(this.pause(),this.$emit("end"),this.$emit("finish"))},reset(){this.pause(),this.remainTime=this.timestamp,this.setRemainTime(this.remainTime),this.autoStart&&this.start()},pause(){this.runing=!1,this.clearTimeout()},clearTimeout(){clearTimeout(this.timer),this.timer=null}},beforeUnmount(){this.clearTimeout()}},[["render",function(e,d,c,f,h,p){const T=l,g=u;return t(),i(g,{class:"u-count-down"},{default:a((()=>[s(e.$slots,"default",{},(()=>[o(T,{class:"u-count-down__text",style:m(c.customStyle)},{default:a((()=>[n(r(h.formattedTime),1)])),_:1},8,["style"])]))])),_:3})}]]);var I=e(d({__name:"productInfo",setup(e){var s=c(!1);const m=f({diff:0}),l=f({amount:"",goodsId:""}),d=f({id:0,name:"",category:"",imageLink:"",description:"",auctionStartTime:"",auctionEndTime:"",startPrice:0,status:"",conditions:""}),O=()=>{l.goodsId=V.id,console.log(l),b(l).then((e=>{console.log(e),200==e.code&&(S({title:"出价成功",duration:1e3}),s.value=!1,setTimeout((()=>{y({url:"/pages/order/index"})}),1e3))}))},V=f({id:"",auctionStates:""});return h((e=>{console.log(e),V.id=e.id,V.auctionStates=e.auctionStates,""!=V.id&&p(V.id).then((e=>{console.log(e.data);const t=e.data;d.id=t.id,d.name=t.name,d.description=t.description,d.startPrice=t.startPrice,d.imageLink=T.base_url+t.imageLink,d.auctionEndTime=t.auctionEndTime,d.auctionStartTime=t.auctionStartTime,function(e){var t=new Date(e.replace(/-/g,"/")),i=new Date,a=t.getTime()-i.getTime();if(a<=0)console.log("结束");else{m.diff=a,console.log(a);var s=Math.floor(a/864e5),o=a%864e5,n=Math.floor(o/36e5),r=o%36e5,l=Math.floor(r/6e4),u=r%6e4,d=Math.round(u/1e3);console.log(" 相差 "+s+"天 "+n+"小时 "+l+" 分钟"+d+" 秒"),console.log(a+"时间差的毫秒数",s+"计算出相差天数",o+"计算天数后剩余的毫秒数",n+"计算出小时数",l+"计算相差分钟数",d+"计算相差秒数")}}(t.auctionEndTime)}))})),(e,c)=>{const f=x(w("u-image"),D),h=u,p=x(w("u-row"),k),T=x(w("u-count-down"),$),b=x(w("u-col"),M),S=x(w("u-button"),v),y=x(w("u-input"),H),I=x(w("u-form-item"),R),P=x(w("u-form"),j),E=x(w("u-popup"),L);return t(),i(h,{class:"productInfo"},{default:a((()=>[o(f,{width:"100%",height:"300rpx",src:d.imageLink},null,8,["src"]),o(h,{style:{"font-size":"medium","font-weight":"550"}},{default:a((()=>[n(r(d.name),1)])),_:1}),o(h,null,{default:a((()=>[n("起拍价："+r(d.startPrice),1)])),_:1}),o(h,null,{default:a((()=>[o(h,{innerHTML:d.description},null,8,["innerHTML"])])),_:1}),o(h,{class:"bidBtn-box"},{default:a((()=>[o(p,null,{default:a((()=>[o(b,{span:5},{default:a((()=>[o(p,null,{default:a((()=>[o(h,{style:{"text-align":"center","font-weight":"600"}},{default:a((()=>[n("距竞拍结束")])),_:1})])),_:1}),o(p,null,{default:a((()=>[o(T,{timestamp:m.diff,style:{"font-size":"medium","font-weight":"600"}},null,8,["timestamp"])])),_:1})])),_:1}),o(b,{span:7},{default:a((()=>[o(S,{type:"error",onClick:c[0]||(c[0]=e=>g(s)?s.value=!0:s=!0),disabled:1!=V.auctionStates},{default:a((()=>[n("竞拍")])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),o(E,{modelValue:_(s),"onUpdate:modelValue":c[2]||(c[2]=e=>g(s)?s.value=e:s=e),mode:"bottom",width:"100%",height:"500rpx"},{default:a((()=>[o(h,{class:"price-box"},{default:a((()=>[n("起拍价："+r(d.startPrice),1)])),_:1}),o(b,{offset:"4",span:4},{default:a((()=>[o(P,{model:l,class:"form-box"},{default:a((()=>[o(I,{"border-bottom":!1},{default:a((()=>[o(y,{border:!0,modelValue:l.amount,"onUpdate:modelValue":c[1]||(c[1]=e=>l.amount=e),type:"number",style:{"text-align":"center"}},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1}),o(S,{class:"bidbtn-box",type:"error",onClick:O},{default:a((()=>[n("确定")])),_:1})])),_:1},8,["modelValue"])])),_:1})}}}),[["__scopeId","data-v-022f7cc2"]]);export{I as default};
